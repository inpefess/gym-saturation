
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/plot_age_agent.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_plot_age_agent.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_plot_age_agent.py:


Random and age agents for Vampire and iProver
==============================================

.. GENERATED FROM PYTHON SOURCE LINES 6-10

Random agent for Vampire
-------------------------

To make a ``gym-saturation`` environment, we have to import the package

.. GENERATED FROM PYTHON SOURCE LINES 10-15

.. code-block:: default


    import gymnasium as gym

    import gym_saturation








.. GENERATED FROM PYTHON SOURCE LINES 16-17

then we can make a prover environment as any other Gymnasium one

.. GENERATED FROM PYTHON SOURCE LINES 17-20

.. code-block:: default


    env = gym.make("Vampire-v0")








.. GENERATED FROM PYTHON SOURCE LINES 21-22

before using the environment, we should reset it

.. GENERATED FROM PYTHON SOURCE LINES 22-25

.. code-block:: default


    observation, info = env.reset()








.. GENERATED FROM PYTHON SOURCE LINES 26-27

``gym-saturation`` environments don't return any ``info``

.. GENERATED FROM PYTHON SOURCE LINES 27-30

.. code-block:: default


    print(info)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    {}




.. GENERATED FROM PYTHON SOURCE LINES 31-32

observation is a tuple of JSON representations of logic clauses

.. GENERATED FROM PYTHON SOURCE LINES 32-37

.. code-block:: default


    import pprint

    pprint.pp(observation)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    ({'literals': 'mult(X0,mult(X1,X2)) = mult(mult(X0,X1),X2)',
      'label': '1',
      'role': 'lemma',
      'inference_rule': 'input',
      'inference_parents': (),
      'birth_step': 0},
     {'literals': 'mult(e,X0) = X0',
      'label': '2',
      'role': 'lemma',
      'inference_rule': 'input',
      'inference_parents': (),
      'birth_step': 0},
     {'literals': 'e = mult(inv(X0),X0)',
      'label': '3',
      'role': 'lemma',
      'inference_rule': 'input',
      'inference_parents': (),
      'birth_step': 0},
     {'literals': 'a = mult(a,a)',
      'label': '4',
      'role': 'lemma',
      'inference_rule': 'input',
      'inference_parents': (),
      'birth_step': 0},
     {'literals': 'e != a',
      'label': '5',
      'role': 'lemma',
      'inference_rule': 'input',
      'inference_parents': (),
      'birth_step': 0})




.. GENERATED FROM PYTHON SOURCE LINES 38-41

We can render the environment state in the TPTP format.
By default, we are trying to prove a basic group theory lemma:
every idempotent element equals the identity

.. GENERATED FROM PYTHON SOURCE LINES 41-44

.. code-block:: default


    env.render()





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    cnf(1, lemma, mult(X0,mult(X1,X2)) = mult(mult(X0,X1),X2), inference(input, [], [])).
    cnf(2, lemma, mult(e,X0) = X0, inference(input, [], [])).
    cnf(3, lemma, e = mult(inv(X0),X0), inference(input, [], [])).
    cnf(4, lemma, a = mult(a,a), inference(input, [], [])).
    cnf(5, lemma, e != a, inference(input, [], [])).




.. GENERATED FROM PYTHON SOURCE LINES 45-47

here is an example of an episode during which we play random actions.
We set the random seed for reproducibility.

.. GENERATED FROM PYTHON SOURCE LINES 47-55

.. code-block:: default


    env.action_space.seed(0)
    terminated, truncated = False, False
    while not (terminated or truncated):
        action = env.action_space.sample()
        observation, reward, terminated, truncated, info = env.step(action)
    env.close()








.. GENERATED FROM PYTHON SOURCE LINES 56-57

the episode terminated with positive reward

.. GENERATED FROM PYTHON SOURCE LINES 57-60

.. code-block:: default


    print(terminated, truncated, reward)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    True False 1.0




.. GENERATED FROM PYTHON SOURCE LINES 61-64

It means we arrived at a contradiction (``$false``) which proves the lemma.
Notice the ``birth_step`` number of a contradiction, it shows how many steps
we did to find proof.

.. GENERATED FROM PYTHON SOURCE LINES 64-66

.. code-block:: default

    pprint.pp(observation[-1])





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    {'literals': '$false',
     'label': '18',
     'role': 'lemma',
     'inference_rule': 'subsumption_resolution',
     'inference_parents': ('17', '5'),
     'birth_step': 1911}




.. GENERATED FROM PYTHON SOURCE LINES 67-71

Age agent for iProver
----------------------

We initialise iProver-based environment in the same way

.. GENERATED FROM PYTHON SOURCE LINES 71-74

.. code-block:: default


    env = gym.make("iProver-v0")








.. GENERATED FROM PYTHON SOURCE LINES 75-77

Instead of a random agent, let's use Age agent which selects actions in the
order they appear

.. GENERATED FROM PYTHON SOURCE LINES 77-86

.. code-block:: default


    observation, info = env.reset()
    terminated, truncated = False, False
    action = 0
    while not (terminated or truncated):
        observation, reward, terminated, truncated, info = env.step(action)
        action += 1
    env.close()





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Loop <_UnixSelectorEventLoop running=False closed=True debug=False> that handles pid 24572 is closed




.. GENERATED FROM PYTHON SOURCE LINES 87-88

We still arrive at contradiction but it takes a different number of steps

.. GENERATED FROM PYTHON SOURCE LINES 88-91

.. code-block:: default


    print(terminated, truncated, reward)
    pprint.pp(observation[-1])




.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    True False 1.0
    {'literals': '$false',
     'label': 'c_86',
     'role': 'lemma',
     'birth_step': 1,
     'inference_rule': 'forward_subsumption_resolution',
     'inference_parents': ('c_85', 'c_53')}





.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 0.985 seconds)


.. _sphx_glr_download_auto_examples_plot_age_agent.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example




    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_age_agent.py <plot_age_agent.py>`

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_age_agent.ipynb <plot_age_agent.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
